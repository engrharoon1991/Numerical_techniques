clc;
clear all;
clc;
h=0.001;
B=10;
kk=100;
M=0.5;
x = 0:h:5;
y = zeros(1,length(x));
z = zeros(1,length(x));
y(1) = 1;
z(1) = 0;
F_yz = @(z) 1*z;
G_yz = @(y,z) -(B/M)*z-(kk/M)*y;
fprintf('---------------------------------------------------------------------------------------------------\n');
fprintf('i     K1       L1       K2       L2       K3       L3       K4       L4         z(i+1)      y(i+1)\n');
fprintf('---------------------------------------------------------------------------------------------------\n');

for i=1:(length(x)-1)
k1 = F_yz(z(i))*h;
L1 = G_yz(y(i),z(i))*h;
k2 = F_yz(z(i)+0.5*L1)*h;
L2 = G_yz(y(i)+0.5*k1,z(i)+0.5*L1)*h;
k3 = F_yz((z(i)+0.5*L2))*h;
L3 = G_yz((y(i)+0.5*k2),(z(i)+0.5*L2))*h;
k4 = F_yz((z(i)+L3))*h;
L4 = G_yz((y(i)+k3),(z(i)+L3))*h;

y(i+1) = y(i) + (1/6)*(k1+2*k2+2*k3+k4);
z(i+1) = z(i) + (1/6)*(L1+2*L2+2*L3+L4);
fprintf('%.0d   %.4f   %.4f   %.4f   %.4f   %.4f   %.4f   %.4f   %.4f   %.4f   %.4f\n', i, k1, L1, k2, L2, k3, L3, k4, L4, z(i+1), y(i+1))

end
